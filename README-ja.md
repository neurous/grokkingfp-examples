# Grokking Functional Programming - 書籍からのソースコード

このプロジェクトには、[「Grokking Functional Programming」](https://michalplachta.com/book) に含まれるすべてのソースコードが含まれています。**これはあなたの学習のお供**です。このプロジェクトは、あなたが本の中のコードを理解するのを助け、追加のリファレンスとして機能し、あなた自身で多くの関数型プログラミングのアイデアを探求することを可能にします。

このプロジェクト（そしてこの本！）を利用する最良の方法は、あなたのコンピュータ上で1ページ、1ページと追っていくことです。そのためには、**このディレクトリで `sbt console` を実行し、本を読み始めてください** (`sbt` がインストールされていない場合は、以下の [ツールのインストールセクション](#installing-the-tools) を読んでください)。さらに、この本の各章が終わると、ソースコードが公開されていることをお知らせします。エディタ(またはIDE)を開いて、この章のコードを含むファイルを読み進めることができます。いくつかの章では `java` と `scala` のサブディレクトリに複数のファイルがあることに注意してください。便宜上、各ファイルの先頭に章番号を付けてあります。

#### 命令型と関数型の例

この本には、両方の世界の例が含まれています：[命令型/OOはJavaで書かれています](./src/main/java)一方、[関数型はScalaで書かれています](./src/main/scala)。この慣例は、本とこのリポジトリの両方で使用されています。

#### 本書では簡略化された Scala を使用しています。

この本は関数型プログラミングを教えているのであって、Scalaを教えているのではありません。ですから、Scalaのすべての機能を使うわけではありません。Scalaのどの機能が本書で使われているかは、本書の付録Aをご覧ください（あるいは、[付録Aのソースコードはこちら](./src/main/scala/chA_ScalaCheatSheet.scala)をご覧ください）。

また、これまで紹介した機能だけを使います。そのため、この本の序盤では、いくつかのことが異なっています。そして後の章で、同じ問題をより読みやすく解決するのに役立つ特定のテクニックを紹介するときには、代わりにそのテクニックを使い始めます。

加えて、ソースコードの中で古い`assert`を使うことで、コードが私たちの望むとおりに動くかどうかをチェックする際に、できるだけ無駄を省くようにしている。テストについての章があり、そこでは完全な機能を持つテスト・ライブラリーを使いますが、その使い方はこの章だけに限定されています。

先に述べた3つの理由、つまり、簡略化されたScalaのサブセットを使うこと、これまでに紹介したものだけを使うこと、そして`assert`と適切なテスト・ライブラリの両方を同時に使うことは、コードベース全体として一貫性がないように感じられるかもしれません。このプロジェクトは学習用に最適化されているため、これは意図的に行われている！

#### :警告： 問題に直面したらどうするか？

コード・レポジトリは、この本が出版されたときに徹底的にテストされました。本書のすべてのコードサンプルは実行可能で、その結果は `assert` されています。しかし、本が出版された後に変更されることもあります。例えば、この本の最後の部分では、実際のクエリを実行する実際のウィキデータAPIを使用しています。将来変更される可能性もあります。さらに、新しいツールが出てきたり、いくつかのツールが非推奨になったり、単に動かなくなったりする可能性もあります。どのような場合でも、[本のウェブページ](https://michalplachta.com/book)にアクセスして、このコードリポジトリの最新版を入手するようにしてください！

もし、コンパイルエラー、ランタイムエラー、IDE の問題など、他の問題に直面した場合は、そちらもお知らせください。

## このリポジトリの使い方

#### ツールのインストール

###### Java Development Kit (JDK) のインストール

JDK をインストールすると、Java や Scala (JVM 言語) のコードを実行できるようになります。わからない場合は、ターミナルで `javac -version` を実行してください。わからない場合は、https://jdk.java.net/17/。

###### **sbt** (Scala ビルドツール) のインストール

`sbt`はScalaエコシステムで使用されるビルドツールです。プロジェクトの作成、ビルド、テストに使用できます。https://www.scala-sbt.org/download.html を参照し、あなたのプラットフォームに `sbt` をインストールする方法を入手してください。

###### 必要なライブラリのインストール

本書の後の章では、いくつかの外部ライブラリを使用する。最も重要なのは、8章から12章では [cats-effect](https://github.com/typelevel/cats-effect) を、9章と10章では [fs2](https://github.com/typelevel/fs2) を、12章では [scalatest](https://github.com/scalatest/scalatest) を使うことです。これらは `sbt` を最初に実行したときに自動的にこのディレクトリにインストールされる。全ての外部ライブラリとそのバージョンは[build.sbt](./build.sbt)ファイルで定義されています。

#### サンプルの実行

すべてが正しくセットアップされていることを確認するために、全章のすべてのサンプルを実行 してみてください。[build.sbt](./build.sbt)ファイルでは、そのためのエイリアスを定義しています。`sbt runAll`を実行することで、全てのサンプルを実行することができる。また、`sbt 'runMain ch08_CastingDie'`のように実行するファイル名を指定することで、特定の章のサンプルを実行することもできます。あるいは、`sbt run`を実行し、実行するファイルを手動で選択する必要があります。

#### `sbt console` を使う

この本でソースコードリポジトリを使用する最も良い方法は、`sbt console` コマンドです。ルートディレクトリで `sbt console` を実行すれば準備完了である！あとは、`sbt console` セッションで本に書かれているコードを書いて、その結果を自分で確認することができます。この本の中で実行可能なスニペットは、グレーのボックスの中に `>` プロンプトが一つ表示されています。各章はゼロから始まるので、新しい章でコードを書き始める前に必ず `:reset` を入力してください。

###### どのように動作するのか？

もし `sbt console` がどのように動作するのか疑問に思うのであれば、このリポジトリに含まれている [build.sbt](./build.sbt) ファイルに全ての答えがあります。このファイルには、この本で使用する必要なライブラリがすべて定義されており、この本のスニペットが `sbt console` で問題なく動作するように、いくつかの自動インポート機能が追加されています。

###### `sbt console` へのサンプルのインポート

既存の関数やモジュールを `sbt console` セッションにインポートすることができる。この機能はこの本の後半で使用します。ここでは、例題がより高度になり、読者が自分で全てを書くことを期待されなくなります。例えば、`:load src/main/scala/ch01_IntroScala.scala` とすると、`ch01_IntroScala.scala` ファイルから全てのトップレベルの関数やオブジェクトがインポートされ、`import ch09_CurrencyExchange.model._` とすると、第9章の為替アプリケーションを実装するために必要な全ての型がインポートされます。

#### IDEの使い方

本書とその演習問題がどのように機能するかに慣れたら、`build.sbt`ファイルをあなたのIDE(例えば[IntelliJ IDEA](https://www.jetbrains.com/idea))にインポートして、そこで演習問題や探索を自由に行うことができます。これは第12章に沿った望ましい方法です。

IDEを開いたら、プロジェクト選択ダイアログで`開く`をクリックし、このリポジトリから`build.sbt`ファイルを選択します。IDE は自動的にプロジェクトをインポートするはずです。

###### 第 12 章でこのリポジトリを使うには？

この本の最後の章である第12章では、機能プログラムのテスト方法を学びます。すべてのテストを自分で書いてみると、一番勉強になります！プロジェクトをIDEにインポートし、`src/test/scala/ch12_TravelGuideTest.scala` ファイルを開いて、そこからすべてのテストを削除します (あるいは、`sbt test` がそのファイルを使わないように、そのファイルを別の場所に移動します)。それから、この章を読みながら、`src/test/scala/ch12_BasicTest.scala` ファイルにすべてのテストを書いてください。ターミナルで `sbt test` を実行してテストを実行することを忘れないでください (`sbt console` ではありません)。

#### IDEでwarningsが表示されるのはなぜですか？

プロジェクトをインポートすると、IDEで多くのwarningsが表示されるかもしれません。これはScalaの簡易版を使っているからです！また、本書の冒頭ですべての機能を使用するわけではありません（すべて徐々に導入されます）。そのため、上級のScalaプログラマーにとってはまったく問題ないIDEのヒントが表示されるかもしれませんが、普遍的なFPの概念を学ぶことが目的であれば、あまり役に立たないかもしれません。もしこの本全体でIDEを使うのであれば（上記の推奨通り第12章だけでなく）、これらのwarningsは無視してください。ただし、この本（[付録A](./src/main/scala/chA_ScalaCheatSheet.scala)を含む）を読み終えたら、必ずこれらのwarningsに戻ってください。その時までに、あなたはこれらのwarningsの多くに慣れ親しみ、すべてを理解し、適用できるようになると確信しています！

## この本のウェブページをぜひご覧ください！

本を読むときに、このリポジトリがとても役に立つことを祈っています。もし何か問題に直面したら、[本のウェブページ](https://michalplachta.com/book)を訪れてください。役に立つヒント、新しい資料、新しい解答、ボーナス練習問題、うまくいかなかったときの連絡方法などが掲載されているはずです！

お楽しみください！

-- Michał Płachta